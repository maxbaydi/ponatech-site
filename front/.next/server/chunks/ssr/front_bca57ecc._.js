module.exports=[22475,a=>{"use strict";var b=a.i(57490),c=a.i(99543);function d({className:a,...d}){return(0,b.jsx)("div",{className:(0,c.cn)("animate-pulse rounded-md bg-primary/10",a),...d})}a.s(["Skeleton",()=>d])},18276,a=>{"use strict";let b=(0,a.i(89047).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],18276)},15859,a=>{"use strict";let b=(0,a.i(89047).default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);a.s(["ChevronDown",()=>b],15859)},56840,a=>{"use strict";var b=a.i(67234),c=a.i(3391),d=a.i(83796),e=a.i(70855);function f(){return(0,b.useQuery)({queryKey:["categories"],queryFn:()=>e.apiClient.getCategories()})}function g(a){return(0,b.useQuery)({queryKey:["category",a],queryFn:()=>e.apiClient.getCategory(a),enabled:!!a})}function h(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>e.apiClient.createCategory(a),onSuccess:()=>{a.invalidateQueries({queryKey:["categories"]})}})}function i(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>e.apiClient.updateCategory(a,b),onSuccess:(b,{id:c})=>{a.invalidateQueries({queryKey:["categories"]}),a.invalidateQueries({queryKey:["category",c]})}})}function j(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>e.apiClient.deleteCategory(a),onSuccess:()=>{a.invalidateQueries({queryKey:["categories"]})}})}a.s(["useCategories",()=>f,"useCategory",()=>g,"useCreateCategory",()=>h,"useDeleteCategory",()=>j,"useUpdateCategory",()=>i])},13497,a=>{"use strict";var b=a.i(57490),c=a.i(51413),d=a.i(99543);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));e.displayName="Textarea",a.s(["Textarea",()=>e])},37188,a=>{"use strict";var b=a.i(57490),c=a.i(51413);a.i(23427);var d=a.i(92021),e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,e)=>{let f=(0,d.createSlot)(`Primitive.${e}`),g=c.forwardRef((a,c)=>{let{asChild:d,...g}=a;return(0,b.jsx)(d?f:e,{...g,ref:c})});return g.displayName=`Primitive.${e}`,{...a,[e]:g}},{}),f=c.forwardRef((a,c)=>(0,b.jsx)(e.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));f.displayName="Label";var g=a.i(99252),h=a.i(99543);let i=(0,g.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),j=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(f,{ref:d,className:(0,h.cn)(i(),a),...c}));j.displayName=f.displayName,a.s(["Label",()=>j],37188)},54254,a=>{"use strict";var b=a.i(51413);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},31862,a=>{"use strict";let b=(0,a.i(89047).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],31862)},30509,a=>{"use strict";var b=a.i(57490),c=a.i(33551),d=a.i(8824),e=a.i(5841),f=a.i(65986),g=a.i(51413),h=a.i(18276),i=a.i(31862),j=a.i(78607),k=a.i(62987),l=a.i(86636),m=a.i(13497),n=a.i(98908),o=a.i(59280),p=a.i(75134),q=a.i(22475),r=a.i(56840);let s="__none__",t=f.z.object({name:f.z.string().min(2,"Введите название категории"),slug:f.z.string().min(2,"Введите slug"),description:f.z.string().optional(),parentId:f.z.string().optional()});function u(){let a=(0,c.useParams)().id,f=(0,c.useRouter)(),{data:u,isLoading:v,error:w}=(0,r.useCategory)(a),{data:x,isLoading:y}=(0,r.useCategories)(),z=(0,r.useUpdateCategory)(),A=(0,g.useRef)(!1),B=(0,g.useRef)(null),C=(0,d.useForm)({resolver:(0,e.zodResolver)(t),defaultValues:{name:"",slug:"",description:"",parentId:""}});(0,g.useEffect)(()=>{B.current!==a&&(B.current=a,A.current=!1)},[a]),(0,g.useEffect)(()=>{u&&x&&!A.current&&(A.current=!0,C.reset({name:u.name,slug:u.slug,description:u.description||"",parentId:u.parentId||""}))},[u,x,C]);let D=async b=>{try{let c=b.parentId!==s&&b.parentId?b.parentId:void 0;await z.mutateAsync({id:a,data:{...b,parentId:c,description:b.description||void 0}}),f.push("/admin/manage-categories")}catch{alert("Ошибка при обновлении категории")}},E=x?.filter(b=>b.id!==a);return v||y?(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)(q.Skeleton,{className:"h-10 w-32 mb-4"}),(0,b.jsx)(q.Skeleton,{className:"h-8 w-48"}),(0,b.jsx)(q.Skeleton,{className:"h-4 w-64 mt-2"})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(q.Skeleton,{className:"h-6 w-40"})}),(0,b.jsxs)(n.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(q.Skeleton,{className:"h-10 w-full"}),(0,b.jsx)(q.Skeleton,{className:"h-10 w-full"})]}),(0,b.jsx)(q.Skeleton,{className:"h-10 w-full"}),(0,b.jsx)(q.Skeleton,{className:"h-24 w-full"})]})]})]}):w||!u?(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)(k.Button,{variant:"ghost",asChild:!0,className:"mb-4",children:(0,b.jsxs)(j.default,{href:"/admin/manage-categories",children:[(0,b.jsx)(h.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Назад к списку"]})})}),(0,b.jsx)(n.Card,{children:(0,b.jsx)(n.CardContent,{className:"p-8 text-center",children:(0,b.jsx)("p",{className:"text-destructive",children:"Категория не найдена"})})})]}):(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)(k.Button,{variant:"ghost",asChild:!0,className:"mb-4",children:(0,b.jsxs)(j.default,{href:"/admin/manage-categories",children:[(0,b.jsx)(h.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Назад к списку"]})}),(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Редактирование категории"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Изменение данных категории товаров"})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"Информация о категории"})}),(0,b.jsx)(n.CardContent,{children:(0,b.jsx)(p.Form,{...C,children:(0,b.jsxs)("form",{onSubmit:C.handleSubmit(D),className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(p.FormField,{control:C.control,name:"name",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Название *"}),(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(l.Input,{placeholder:"Название категории",...a})}),(0,b.jsx)(p.FormMessage,{})]})}),(0,b.jsx)(p.FormField,{control:C.control,name:"slug",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Slug *"}),(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(l.Input,{placeholder:"category-slug",...a})}),(0,b.jsx)(p.FormMessage,{})]})})]}),(0,b.jsx)(p.FormField,{control:C.control,name:"parentId",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Родительская категория"}),(0,b.jsxs)(o.Select,{onValueChange:a.onChange,value:a.value||s,children:[(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(o.SelectTrigger,{children:(0,b.jsx)(o.SelectValue,{placeholder:"Выберите родительскую категорию (опционально)"})})}),(0,b.jsxs)(o.SelectContent,{children:[(0,b.jsx)(o.SelectItem,{value:s,children:"Нет (корневая категория)"}),E?.map(a=>(0,b.jsx)(o.SelectItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)(p.FormMessage,{})]})}),(0,b.jsx)(p.FormField,{control:C.control,name:"description",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Описание"}),(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(m.Textarea,{placeholder:"Описание категории...",className:"min-h-[100px]",...a})}),(0,b.jsx)(p.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,b.jsx)(k.Button,{variant:"outline",type:"button",asChild:!0,children:(0,b.jsx)(j.default,{href:"/admin/manage-categories",children:"Отмена"})}),(0,b.jsxs)(k.Button,{type:"submit",disabled:z.isPending,children:[z.isPending&&(0,b.jsx)(i.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Сохранить изменения"]})]})]})})})]})]})}a.s(["default",()=>u])}];

//# sourceMappingURL=front_bca57ecc._.js.map