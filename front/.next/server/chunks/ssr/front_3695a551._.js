module.exports=[22475,a=>{"use strict";var b=a.i(57490),c=a.i(99543);function d({className:a,...d}){return(0,b.jsx)("div",{className:(0,c.cn)("animate-pulse rounded-md bg-primary/10",a),...d})}a.s(["Skeleton",()=>d])},18276,a=>{"use strict";let b=(0,a.i(89047).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],18276)},15859,a=>{"use strict";let b=(0,a.i(89047).default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);a.s(["ChevronDown",()=>b],15859)},56840,a=>{"use strict";var b=a.i(67234),c=a.i(3391),d=a.i(83796),e=a.i(70855);function f(){return(0,b.useQuery)({queryKey:["categories"],queryFn:()=>e.apiClient.getCategories()})}function g(a){return(0,b.useQuery)({queryKey:["category",a],queryFn:()=>e.apiClient.getCategory(a),enabled:!!a})}function h(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>e.apiClient.createCategory(a),onSuccess:()=>{a.invalidateQueries({queryKey:["categories"]})}})}function i(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>e.apiClient.updateCategory(a,b),onSuccess:(b,{id:c})=>{a.invalidateQueries({queryKey:["categories"]}),a.invalidateQueries({queryKey:["category",c]})}})}function j(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>e.apiClient.deleteCategory(a),onSuccess:()=>{a.invalidateQueries({queryKey:["categories"]})}})}a.s(["useCategories",()=>f,"useCategory",()=>g,"useCreateCategory",()=>h,"useDeleteCategory",()=>j,"useUpdateCategory",()=>i])},13497,a=>{"use strict";var b=a.i(57490),c=a.i(51413),d=a.i(99543);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));e.displayName="Textarea",a.s(["Textarea",()=>e])},37188,a=>{"use strict";var b=a.i(57490),c=a.i(51413);a.i(23427);var d=a.i(92021),e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,e)=>{let f=(0,d.createSlot)(`Primitive.${e}`),g=c.forwardRef((a,c)=>{let{asChild:d,...g}=a;return(0,b.jsx)(d?f:e,{...g,ref:c})});return g.displayName=`Primitive.${e}`,{...a,[e]:g}},{}),f=c.forwardRef((a,c)=>(0,b.jsx)(e.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));f.displayName="Label";var g=a.i(99252),h=a.i(99543);let i=(0,g.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),j=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(f,{ref:d,className:(0,h.cn)(i(),a),...c}));j.displayName=f.displayName,a.s(["Label",()=>j],37188)},54254,a=>{"use strict";var b=a.i(51413);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},31862,a=>{"use strict";let b=(0,a.i(89047).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],31862)},45954,a=>{"use strict";var b=a.i(67234),c=a.i(3391),d=a.i(83796),e=a.i(70855);function f(){return(0,b.useQuery)({queryKey:["brands"],queryFn:()=>e.apiClient.getBrands()})}function g(a){return(0,b.useQuery)({queryKey:["brand",a],queryFn:()=>e.apiClient.getBrand(a),enabled:!!a})}function h(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>e.apiClient.createBrand(a),onSuccess:()=>{a.invalidateQueries({queryKey:["brands"]})}})}function i(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>e.apiClient.updateBrand(a,b),onSuccess:(b,{id:c})=>{a.invalidateQueries({queryKey:["brands"]}),a.invalidateQueries({queryKey:["brand",c]})}})}function j(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>e.apiClient.deleteBrand(a),onSuccess:()=>{a.invalidateQueries({queryKey:["brands"]})}})}a.s(["useBrand",()=>g,"useBrands",()=>f,"useCreateBrand",()=>h,"useDeleteBrand",()=>j,"useUpdateBrand",()=>i])},41346,a=>{"use strict";var b=a.i(67234),c=a.i(3391),d=a.i(83796),e=a.i(70855);function f(a){return(0,b.useQuery)({queryKey:["products",a],queryFn:()=>e.apiClient.getProducts(a)})}function g(a){return(0,b.useQuery)({queryKey:["product",a],queryFn:()=>e.apiClient.getProduct(a),enabled:!!a})}function h(a){return(0,b.useQuery)({queryKey:["product","slug",a],queryFn:()=>e.apiClient.getProductBySlug(a),enabled:!!a})}function i(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>e.apiClient.createProduct(a),onSuccess:()=>{a.invalidateQueries({queryKey:["products"]})}})}function j(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>e.apiClient.updateProduct(a,b),onSuccess:(b,{id:c})=>{a.invalidateQueries({queryKey:["products"]}),a.invalidateQueries({queryKey:["product",c]})}})}function k(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>e.apiClient.deleteProduct(a),onSuccess:()=>{a.invalidateQueries({queryKey:["products"]})}})}a.s(["useCreateProduct",()=>i,"useDeleteProduct",()=>k,"useProduct",()=>g,"useProductBySlug",()=>h,"useProducts",()=>f,"useUpdateProduct",()=>j])},21854,a=>{"use strict";var b=a.i(57490),c=a.i(33551),d=a.i(8824),e=a.i(5841),f=a.i(65986),g=a.i(51413),h=a.i(18276),i=a.i(31862),j=a.i(78607),k=a.i(62987),l=a.i(86636),m=a.i(13497),n=a.i(98908),o=a.i(59280),p=a.i(75134),q=a.i(22475),r=a.i(41346),s=a.i(45954),t=a.i(56840);let u=f.z.object({title:f.z.string().min(2,"Введите название товара"),slug:f.z.string().min(2,"Введите slug"),sku:f.z.string().min(2,"Введите SKU"),description:f.z.string().optional(),price:f.z.coerce.number().min(0,"Цена должна быть положительной"),currency:f.z.string().default("RUB"),status:f.z.enum(["DRAFT","PUBLISHED","ARCHIVED"]),stock:f.z.coerce.number().min(0).default(0),brandId:f.z.string().min(1,"Выберите бренд"),categoryId:f.z.string().min(1,"Выберите категорию")});function v(){let a=(0,c.useParams)().id,f=(0,c.useRouter)(),{data:v,isLoading:w,error:x}=(0,r.useProduct)(a),y=(0,r.useUpdateProduct)(),{data:z,isLoading:A}=(0,s.useBrands)(),{data:B,isLoading:C}=(0,t.useCategories)(),D=(0,g.useRef)(!1),E=(0,g.useRef)(null),F=(0,d.useForm)({resolver:(0,e.zodResolver)(u),defaultValues:{title:"",slug:"",sku:"",description:"",price:0,currency:"RUB",status:"DRAFT",stock:0,brandId:"",categoryId:""}});(0,g.useEffect)(()=>{E.current!==a&&(E.current=a,D.current=!1)},[a]),(0,g.useEffect)(()=>{v&&z&&B&&!D.current&&(D.current=!0,F.reset({title:v.title,slug:v.slug,sku:v.sku,description:v.description||"",price:Number(v.price),currency:v.currency,status:v.status,stock:v.stock,brandId:v.brandId,categoryId:v.categoryId}))},[v,z,B,F]);let G=async b=>{try{await y.mutateAsync({id:a,data:{...b,attributes:v?.attributes||{}}}),f.push("/admin/manage-products")}catch{alert("Ошибка при обновлении товара")}};return w||A||C?(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)(q.Skeleton,{className:"h-10 w-32 mb-4"}),(0,b.jsx)(q.Skeleton,{className:"h-8 w-48"}),(0,b.jsx)(q.Skeleton,{className:"h-4 w-64 mt-2"})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(q.Skeleton,{className:"h-6 w-40"})}),(0,b.jsxs)(n.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(q.Skeleton,{className:"h-10 w-full"}),(0,b.jsx)(q.Skeleton,{className:"h-10 w-full"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsx)(q.Skeleton,{className:"h-10 w-full"}),(0,b.jsx)(q.Skeleton,{className:"h-10 w-full"}),(0,b.jsx)(q.Skeleton,{className:"h-10 w-full"})]}),(0,b.jsx)(q.Skeleton,{className:"h-24 w-full"})]})]})]}):x||!v?(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)(k.Button,{variant:"ghost",asChild:!0,className:"mb-4",children:(0,b.jsxs)(j.default,{href:"/admin/manage-products",children:[(0,b.jsx)(h.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Назад к списку"]})})}),(0,b.jsx)(n.Card,{children:(0,b.jsx)(n.CardContent,{className:"p-8 text-center",children:(0,b.jsx)("p",{className:"text-destructive",children:"Товар не найден"})})})]}):(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)(k.Button,{variant:"ghost",asChild:!0,className:"mb-4",children:(0,b.jsxs)(j.default,{href:"/admin/manage-products",children:[(0,b.jsx)(h.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Назад к списку"]})}),(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Редактирование товара"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Изменение данных товара в каталоге"})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"Информация о товаре"})}),(0,b.jsx)(n.CardContent,{children:(0,b.jsx)(p.Form,{...F,children:(0,b.jsxs)("form",{onSubmit:F.handleSubmit(G),className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(p.FormField,{control:F.control,name:"title",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Название *"}),(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(l.Input,{placeholder:"Название товара",...a})}),(0,b.jsx)(p.FormMessage,{})]})}),(0,b.jsx)(p.FormField,{control:F.control,name:"slug",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Slug *"}),(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(l.Input,{placeholder:"slug-tovara",...a})}),(0,b.jsx)(p.FormMessage,{})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsx)(p.FormField,{control:F.control,name:"sku",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"SKU *"}),(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(l.Input,{placeholder:"ABC-123",...a})}),(0,b.jsx)(p.FormMessage,{})]})}),(0,b.jsx)(p.FormField,{control:F.control,name:"price",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Цена *"}),(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(l.Input,{type:"number",step:"0.01",...a})}),(0,b.jsx)(p.FormMessage,{})]})}),(0,b.jsx)(p.FormField,{control:F.control,name:"stock",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Остаток"}),(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(l.Input,{type:"number",...a})}),(0,b.jsx)(p.FormMessage,{})]})})]}),(0,b.jsx)(p.FormField,{control:F.control,name:"description",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Описание"}),(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(m.Textarea,{placeholder:"Описание товара...",className:"min-h-[100px]",...a})}),(0,b.jsx)(p.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsx)(p.FormField,{control:F.control,name:"brandId",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Бренд *"}),(0,b.jsxs)(o.Select,{onValueChange:a.onChange,value:a.value,children:[(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(o.SelectTrigger,{children:(0,b.jsx)(o.SelectValue,{placeholder:"Выберите бренд"})})}),(0,b.jsx)(o.SelectContent,{children:z?.map(a=>(0,b.jsx)(o.SelectItem,{value:a.id,children:a.name},a.id))})]}),(0,b.jsx)(p.FormMessage,{})]})}),(0,b.jsx)(p.FormField,{control:F.control,name:"categoryId",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Категория *"}),(0,b.jsxs)(o.Select,{onValueChange:a.onChange,value:a.value,children:[(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(o.SelectTrigger,{children:(0,b.jsx)(o.SelectValue,{placeholder:"Выберите категорию"})})}),(0,b.jsx)(o.SelectContent,{children:B?.map(a=>(0,b.jsx)(o.SelectItem,{value:a.id,children:a.name},a.id))})]}),(0,b.jsx)(p.FormMessage,{})]})}),(0,b.jsx)(p.FormField,{control:F.control,name:"status",render:({field:a})=>(0,b.jsxs)(p.FormItem,{children:[(0,b.jsx)(p.FormLabel,{children:"Статус"}),(0,b.jsxs)(o.Select,{onValueChange:a.onChange,value:a.value,children:[(0,b.jsx)(p.FormControl,{children:(0,b.jsx)(o.SelectTrigger,{children:(0,b.jsx)(o.SelectValue,{})})}),(0,b.jsxs)(o.SelectContent,{children:[(0,b.jsx)(o.SelectItem,{value:"DRAFT",children:"Черновик"}),(0,b.jsx)(o.SelectItem,{value:"PUBLISHED",children:"Опубликован"}),(0,b.jsx)(o.SelectItem,{value:"ARCHIVED",children:"В архиве"})]})]}),(0,b.jsx)(p.FormMessage,{})]})})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,b.jsx)(k.Button,{variant:"outline",type:"button",asChild:!0,children:(0,b.jsx)(j.default,{href:"/admin/manage-products",children:"Отмена"})}),(0,b.jsxs)(k.Button,{type:"submit",disabled:y.isPending,children:[y.isPending&&(0,b.jsx)(i.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Сохранить изменения"]})]})]})})})]})]})}a.s(["default",()=>v])}];

//# sourceMappingURL=front_3695a551._.js.map